<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="BSPLINE-FORTRAN -- Multidimensional B-Spline Interpolation of Data on a Regular Grid">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>dbint4 &ndash; bspline-fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">bspline-fortran </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>dbint4
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="10.8% of total for procedures.">137 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/bspline_sub_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/bspline_sub_module.f90.html'>bspline_sub_module.f90</a></li>
    
     <li><a href='../module/bspline_sub_module.html'>bspline_sub_module</a></li>
    
  
     <li class="active">dbint4</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dbint4.html#src">dbint4</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public pure subroutine dbint4(x, y, ndata, ibcl, ibcr, fbcl, fbcr, kntopt, t, bcoef, n, k, w, iflag)
    
    
   
</h2>
    
  


    
    <p>DBINT4 computes the B representation (T,BCOEF,N,K) of a
  cubic spline (K=4) which interpolates data (X(I),Y(I)),
  I=1,NDATA.  Parameters IBCL, IBCR, FBCL, FBCR allow the
  specification of the spline first or second derivative at
  both X(1) and X(NDATA).  When this data is not specified
  by the problem, it is common practice to use a natural
  spline by setting second derivatives at X(1) and X(NDATA)
  to zero (IBCL=IBCR=2,FBCL=FBCR=0.0).  The spline is defined
  on T(4) &lt;= X &lt;= T(N+1) with (ordered) interior knots at
  X(I) values where N=NDATA+2.  The knots T(1),T(2),T(3) lie to
  the left of T(4)=X(1) and the knots T(N+2), T(N+3), T(N+4)
  lie to the right of T(N+1)=X(NDATA) in increasing order.  If
  no extrapolation outside (X(1),X(NDATA)) is anticipated, the
  knots T(1)=T(2)=T(3)=T(4)=X(1) and T(N+2)=T(N+3)=T(N+4)=
  T(N+1)=X(NDATA) can be specified by KNTOPT=1.  KNTOPT=2
  selects a knot placement for T(1), T(2), T(3) to make the
  first 7 knots symmetric about T(4)=X(1) and similarly for
  T(N+2), T(N+3), T(N+4) about T(N+1)=X(NDATA).  KNTOPT=3
  allows the user to make his own selection, in increasing
  order, for T(1), T(2), T(3) to the left of X(1) and T(N+2),
  T(N+3), T(N+4) to the right of X(NDATA) in the work array
  W(1) through W(6).  In any case, the interpolation on
  T(4) &lt;= X &lt;= T(N+1) by using function DBVALU is unique
  for given boundary conditions.</p>
<h3>Error conditions</h3>
<ul>
<li>improper input</li>
<li>singular system of equations</li>
</ul>
<h3>See also</h3>
<ul>
<li><a>dbintk</a></li>
</ul>
<h3>History</h3>
<ul>
<li>Written by D. E. Amos (SNLA), August, 1979.</li>
<li>date written 800901</li>
<li>revision date 820801</li>
<li>000330  Modified array declarations.  (JEC)</li>
<li>Jacob Williams, 8/30/2018 : refactored to modern Fortran.</li>
</ul>
<p></p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p><code>w</code> work array input is very old fashioned and unclear. need to fix that.
         just input <code>t(1:3) = tstart(1:3)</code> and <code>t(ndata+4:ndata+6) = tend(1:3)</code>.</p></div>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x%7E8"></span>real(kind=wp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>x</strong></td><td><p>X vector of abscissae of length NDATA, distinct
 and in increasing order</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y%7E6"></span>real(kind=wp),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>y</strong></td><td><p>y vector of ordinates of length ndata</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ndata"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ndata</strong></td><td><p>number of data points, ndata &gt;= 2</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ibcl"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ibcl</strong></td><td><p>selection parameter for left boundary condition:</p>
<ul>
<li>ibcl = 1 constrain the first derivative at x(1) to fbcl</li>
<li>ibcl = 2 constrain the second derivative at x(1) to fbcl</li>
</ul></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ibcr"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ibcr</strong></td><td><p>selection parameter for right boundary condition:</p>
<ul>
<li>ibcr = 1 constrain first derivative at x(ndata) to fbcr</li>
<li>ibcr = 2 constrain second derivative at x(ndata) to fbcr</li>
</ul></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fbcl"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>fbcl</strong></td><td><p>left boundary values governed by ibcl</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-fbcr"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>fbcr</strong></td><td><p>right boundary values governed by ibcr</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-kntopt"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kntopt</strong></td><td><p>knot selection parameter:</p>
<ul>
<li>kntopt = 1 sets knot multiplicity at t(4) and
   t(n+1) to 4</li>
<li>kntopt = 2 sets a symmetric placement of knots
   about t(4) and t(n+1)</li>
<li>kntopt = 3 sets t(i)=w(i) and t(n+1+i)=w(3+i),i=1,3
   where w(i),i=1,6 is supplied by the user</li>
</ul></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t"></span>real(kind=wp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>t</strong></td><td><p>knot array of length n+4</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bcoef%7E15"></span>real(kind=wp),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>bcoef</strong></td><td><p>b spline coefficient array of length n</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td><p>number of coefficients, n=ndata+2</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td><p>order of spline, k=4</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-w"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(5,*)</td><td>::</td>
  <td><strong>w</strong></td><td><p>work array of dimension at least 5*(ndata+2)
 if kntopt=3, then w(1),w(2),w(3) are knot values to
 the left of x(1) and w(4),w(5),w(6) are knot
 values to the right of x(ndata) in increasing
 order to be supplied by the user.
 Note that the values are changed by this routine.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iflag%7E16"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iflag</strong></td><td><p>status flag:</p>
<ul>
<li>0: no errors</li>
<li>2001: ndata is less than 2</li>
<li>2002: x values are not distinct or not ordered</li>
<li>2003: ibcl is not 1 or 2</li>
<li>2004: ibcr is not 1 or 2</li>
<li>2005: kntopt is not 1, 2, or 3</li>
<li>2006: knot input through w array is not ordered properly</li>
<li>2007: the system of equations is singular</li>
</ul></td>
  
</tr>

</tbody>
</table>

    
    
    
    
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dbint4.html#src">dbint4</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">pure subroutine </span><span class="n">dbint4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ndata</span><span class="p">,</span><span class="n">ibcl</span><span class="p">,</span><span class="n">ibcr</span><span class="p">,</span><span class="n">fbcl</span><span class="p">,</span><span class="n">fbcr</span><span class="p">,</span><span class="n">kntopt</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">bcoef</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">iflag</span><span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">x</span>       <span class="c">!! X vector of abscissae of length NDATA, distinct</span>
                                                  <span class="c">!! and in increasing order</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">y</span>       <span class="c">!! y vector of ordinates of length ndata</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ndata</span>   <span class="c">!! number of data points, ndata &gt;= 2</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ibcl</span>    <span class="c">!! selection parameter for left boundary condition:</span>
                                                  <span class="c">!!</span>
                                                  <span class="c">!! * ibcl = 1 constrain the first derivative at x(1) to fbcl</span>
                                                  <span class="c">!! * ibcl = 2 constrain the second derivative at x(1) to fbcl</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">ibcr</span>    <span class="c">!! selection parameter for right boundary condition:</span>
                                                  <span class="c">!!</span>
                                                  <span class="c">!! * ibcr = 1 constrain first derivative at x(ndata) to fbcr</span>
                                                  <span class="c">!! * ibcr = 2 constrain second derivative at x(ndata) to fbcr</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">fbcl</span>    <span class="c">!! left boundary values governed by ibcl</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">fbcr</span>    <span class="c">!! right boundary values governed by ibcr</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">kntopt</span>  <span class="c">!! knot selection parameter:</span>
                                                  <span class="c">!!</span>
                                                  <span class="c">!! * kntopt = 1 sets knot multiplicity at t(4) and</span>
                                                  <span class="c">!!   t(n+1) to 4</span>
                                                  <span class="c">!! * kntopt = 2 sets a symmetric placement of knots</span>
                                                  <span class="c">!!   about t(4) and t(n+1)</span>
                                                  <span class="c">!! * kntopt = 3 sets t(i)=w(i) and t(n+1+i)=w(3+i),i=1,3</span>
                                                  <span class="c">!!   where w(i),i=1,6 is supplied by the user</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">t</span>       <span class="c">!! knot array of length n+4</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">bcoef</span>   <span class="c">!! b spline coefficient array of length n</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">n</span>       <span class="c">!! number of coefficients, n=ndata+2</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">k</span>       <span class="c">!! order of spline, k=4</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w</span>    <span class="c">!! work array of dimension at least 5*(ndata+2)</span>
                                                  <span class="c">!! if kntopt=3, then w(1),w(2),w(3) are knot values to</span>
                                                  <span class="c">!! the left of x(1) and w(4),w(5),w(6) are knot</span>
                                                  <span class="c">!! values to the right of x(ndata) in increasing</span>
                                                  <span class="c">!! order to be supplied by the user.</span>
                                                  <span class="c">!! Note that the values are changed by this routine.</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">iflag</span>     <span class="c">!! status flag:</span>
                                                  <span class="c">!!</span>
                                                  <span class="c">!! * 0: no errors</span>
                                                  <span class="c">!! * 2001: ndata is less than 2</span>
                                                  <span class="c">!! * 2002: x values are not distinct or not ordered</span>
                                                  <span class="c">!! * 2003: ibcl is not 1 or 2</span>
                                                  <span class="c">!! * 2004: ibcr is not 1 or 2</span>
                                                  <span class="c">!! * 2005: kntopt is not 1, 2, or 3</span>
                                                  <span class="c">!! * 2006: knot input through w array is not ordered properly</span>
                                                  <span class="c">!! * 2007: the system of equations is singular</span>

    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ilb</span><span class="p">,</span> <span class="n">ileft</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">iub</span><span class="p">,</span> <span class="n">iw</span><span class="p">,</span> <span class="n">iwp</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">jw</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nwrow</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">txn</span><span class="p">,</span> <span class="n">tx1</span><span class="p">,</span> <span class="n">xl</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vnikx</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="kd">::</span> <span class="n">work</span>  <span class="c">!! work array for [[dbspvd]] -- length (k+1)*(k+2)/2</span>

    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">wdtol</span> <span class="o">=</span> <span class="nb">radix</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">digits</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="p">))</span> <span class="c">!! d1mach(4)</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">wdtol</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ndata</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2001</span> <span class="c">! ndata is less than 2</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    </span><span class="n">ndm</span> <span class="o">=</span> <span class="n">ndata</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ndm</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<span class="k">            </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2002</span> <span class="c">! x values are not distinct or not ordered</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">    end do</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">ibcl</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ibcl</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2003</span> <span class="c">! ibcl is not 1 or 2</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">ibcr</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ibcr</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2004</span> <span class="c">! ibcr is not 1 or 2</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    if</span> <span class="p">(</span><span class="n">kntopt</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">kntopt</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2005</span> <span class="c">! kntopt is not 1, 2, or 3</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ndata</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">np</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ndata</span>
        <span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">end do</span>

<span class="k">    select case</span> <span class="p">(</span><span class="n">kntopt</span><span class="p">)</span>
    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c">! set up knot array with multiplicity 4 at x(1) and x(ndata)</span>
        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
            <span class="n">t</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="k">    case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="c">!set up knot array with symmetric placement about end points</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ndata</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            </span><span class="n">tx1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">txn</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
                <span class="n">t</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">tx1</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">txn</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">        else</span>
<span class="k">            </span><span class="n">xl</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">3.0_wp</span>
            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
                <span class="n">t</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xl</span>
                <span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">xl</span>
            <span class="k">end do</span>
<span class="k">        end if</span>
<span class="k">    case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="c">! set up knot array less than x(1) and greater than x(ndata) to be</span>
        <span class="c">! supplied by user in work locations w(1) through w(6) when kntopt=3</span>
        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
            <span class="n">t</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">jw</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">iw</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="n">iw</span><span class="p">,</span><span class="n">jw</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">t</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="n">t</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">i</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t</span><span class="p">(</span><span class="n">np</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="k">then</span>
<span class="k">                </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2006</span> <span class="c">! knot input through w array is not ordered properly</span>
                <span class="k">return</span>
<span class="k">            end if</span>
<span class="k">        end do</span>
<span class="k">    end select</span>

<span class="k">    do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
        <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
            <span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_wp</span>
        <span class="k">end do</span>
<span class="k">    end do</span>

    <span class="c">! set up left interpolation point and left boundary condition for</span>
    <span class="c">! right limits</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">ibcl</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">dbspvd</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">vnikx</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">iflag</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iflag</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="c">! error check</span>
    <span class="n">iw</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">vnikx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">)</span> <span class="n">iw</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
        <span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">vnikx</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
        <span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">vnikx</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    </span><span class="n">bcoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bcoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">fbcl</span>
    <span class="c">! set up interpolation equations for points i=2 to i=ndata-1</span>
    <span class="n">ileft</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ndm</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        do </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ndm</span>
            <span class="n">ileft</span> <span class="o">=</span> <span class="n">ileft</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="n">dbspvd</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">ileft</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">vnikx</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">iflag</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">iflag</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="c">! error check</span>
            <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
                <span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">vnikx</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">bcoef</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">end do</span>
<span class="k">    end if</span>

    <span class="c">! set up right interpolation point and right boundary condition for</span>
    <span class="c">! left limits(ileft is associated with t(n)=x(ndata-1))</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">ibcr</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">dbspvd</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">ndata</span><span class="p">),</span> <span class="n">ileft</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">vnikx</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">iflag</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iflag</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="c">! error check</span>
    <span class="n">jw</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">vnikx</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">&lt;</span><span class="n">tol</span><span class="p">)</span> <span class="n">jw</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
        <span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">ndata</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">vnikx</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
        <span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">ndata</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">vnikx</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">    </span><span class="n">bcoef</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">fbcr</span>
    <span class="n">bcoef</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">ndata</span><span class="p">)</span>
    <span class="c">! solve system of equations</span>
    <span class="n">ilb</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">jw</span>
    <span class="n">iub</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">iw</span>
    <span class="n">nwrow</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">iwp</span> <span class="o">=</span> <span class="n">iw</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">dbnfac</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">iwp</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">nwrow</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ilb</span><span class="p">,</span> <span class="n">iub</span><span class="p">,</span> <span class="n">iflag</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iflag</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        </span><span class="n">iflag</span> <span class="o">=</span> <span class="mi">2007</span> <span class="c">! the system of equations is singular</span>
        <span class="k">return</span>
<span class="k">    else</span>
        <span class="c">! success</span>
        <span class="n">iflag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">end if</span>
<span class="k">    call </span><span class="n">dbnslv</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">iwp</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">nwrow</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ilb</span><span class="p">,</span> <span class="n">iub</span><span class="p">,</span> <span class="n">bcoef</span><span class="p">)</span>

    <span class="k">end subroutine </span><span class="n">dbint4</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> bspline-fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>